# mspModularization
MSP Code Modularization (Separating code and introducing ES6 Features)

Terminology: 
1. **Non-ES6-Component**: Any file or group of files that have not yet been modularized i.e Are not written in and exported as ES6 Modules. (Similar to spaghetti code). These files are found in `/components`.
2. **Module**: These are ES6 modules found in the `/modules` folder. 

## About the Repo
There are 4 major folders:
1. `components`: All the Non-ES6-Components. Plain javascript files divided based on separation of concern. (Expected to be non-working)
2. `modules`: These files are written as ES6 bundles (Desired/target file structure). It contains the `utils` folder that has all the basic modules (required by a generic site).
3. `old_files`: Contains code that is assumed to be obsolete. Placed here just in case we need to bring some feature back.
4. `dist`: Contains the distribution files that will be eventually used as scripts or requireJS modules on the browser.

There are 2 important files in the root:
1. `main.js`: This basically imports and re-exports all the modules from the `modules` folder for use by Non-ES6-Components (So that they can be used as a parameter in the define() or require() function callbacks of AMD).
2. `index.html`: The page to run in the browser. It adds `jqeury` and `requirejs`. An inline script tag includes the bundled ES6 modules as a dependency of the bundled non ES6 components.

## Testing the Modules
1. Run `gulp` to bundle all the Non-ES6-Components into a file called `all-non-module-components.js` in the `dist` folder. It is one big AMD module.
2. Run `rollup -c` to transpile, bundle, AMDify, and minify the ES6 modules. The resulting file in the `dist` folder is `modules-bundle.js`
3. Run the `index.html` file in the browser.

### Fixing Bugs:
1. Bug fix in `dist/all-non-module-components.js`: Do not edit this file instead locate the corresponding file in the `components` folder (Sourcemap will help you). Edit that file (apply the fix) and run `gulp` to regenerate `dist/all-non-module-components.js`. 
2. Bug fix in `dist/modules-bundle.js`: Sourcemap will help you locate the corresponding module. Edit that module and run `rollup -c`. This regenerates `dist/modules-bundle.js`.

### Converting a Non-ES6-Component to a Module
1. Create the corresponding folder for the component in the `modules` folder.
2. Import and Export the component in the `/main.js` file. This makes it available outside modules to Non-ES6-Components.
3. Remove the Non-ES6-Component from the `components` folder since it has been added to the modules.
